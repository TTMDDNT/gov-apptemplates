{% assign defaultlang = settings['LanguageLocale/Code'] | default: 'en-us' %}
{% assign homeurl = website.adx_partialurl %}

<!-- Skip to main content -->
<a class="usa-skipnav" href="#main-content">{{ resx.Skip_To_Content | default: "Skip to main content" }}</a>

<!-- USWDS Banner -->
<section class="usa-banner site-banner" aria-label="Official website of the United States government">
    <div class="usa-accordion">
        <header class="usa-banner__header">
            <div class="usa-banner__inner">
                <div class="grid-col-auto">
                    <img aria-hidden="true" class="usa-banner__header-flag" src="/us_flag_small.png" alt="">
                </div>
                <div class="grid-col-fill tablet:grid-col-auto">
                    <p class="usa-banner__header-text">
                        A sample website for government agencies
                    </p>
                </div>
                <div class="grid-col-auto">
                    <button type="button" class="usa-accordion__button usa-banner__button" aria-expanded="false" aria-controls="gov-banner">
                        <span class="usa-banner__button-text">Here's how you know</span>
                    </button>
                </div>
            </div>
        </header>
        <!-- Expandable Details -->
        <div class="usa-banner__content usa-accordion__content" id="gov-banner" hidden="">
            <div class="grid-row grid-gap-lg">
                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img" src="/icon-dot-gov.svg" role="img" alt="" aria-hidden="true">
                    <div class="usa-media-block__body">
                        <p>
                            <strong>Official websites use .gov</strong><br>A
                            <strong>.gov</strong> website belongs to an official government
                            organization in the United States.
                        </p>
                    </div>
                </div>
                <div class="usa-banner__guidance tablet:grid-col-6">
                    <img class="usa-banner__icon usa-media-block__img" src="/icon-https.svg" role="img" alt="" aria-hidden="true">
                    <div class="usa-media-block__body">
                        <p>
                            <strong>Secure .gov websites use HTTPS</strong><br>A
                            <strong>lock</strong> (üîí) or <strong>https://</strong> means you've safely connected to
                            the .gov website. Share sensitive information only on official,
                            secure websites.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Site Logo and Name -->
<header class="usa-header usa-header--extended site-header site-header--dark" role="banner">
    <div class="usa-navbar site-header__navbar">
        <div class="grid-col-auto">
            <div class="usa-logo site-logo" id="logo">
                <em class="usa-logo__text site-logo__text">
                    <a href="{% if homeurl%}/{{ homeurl }}{% else %}/{% endif %}" title="Home">
                        <img class="usa-logo__img site-logo__img" src="/Logo-sm-64.png" alt="">
                        {% editable snippets 'Site name' default: website.name %}
                    </a>
                </em>
            </div>
        </div>
        <div class="grid-col-auto">
            <button type="button" class="usa-menu-btn">Menu</button>
        </div>
    </div>
</header>

<!-- Primary Navigation -->
<nav aria-label="Primary navigation" class="usa-nav site-nav">
    <div class="usa-nav__inner site-nav__inner">
        <!-- Close Button (Mobile Only) -->
        <button type="button" class="usa-nav__close">
            <span aria-hidden="true">‚úï</span> Close
        </button>
        
        <!-- Mobile nav -->
        <ul class="usa-nav__primary usa-nav__primary--mobile usa-accordion">
            {% assign primary_nav = weblinks["Primary Navigation"] | default: weblinks["Default"] %}
            {% if primary_nav %}
                {% for link in primary_nav.weblinks %}
                    {% if link.display_page_child_links %}
                        {% if link.url != null %}
                            {% assign sublinks = sitemap[link.url].children %}
                        {% endif %}
                    {% else %}
                        {% assign sublinks = link.weblinks %}
                    {% endif %}
                    
                    <li class="usa-nav__primary-item">
                        {% if sublinks.size > 0 %}
                            <button type="button" class="usa-accordion__button usa-nav__link" aria-controls="nav-{{ forloop.index }}" aria-expanded="false">
                                <span>{{ link.name | escape }}</span>
                            </button>
                            <ul id="nav-{{ forloop.index }}" class="usa-nav__submenu" hidden="">
                                {% for sublink in sublinks %}
                                    <li class="usa-nav__submenu-item">
                                        <a href="{{ sublink.url | escape }}"><span>{{ sublink.name | default:sublink.title | escape }}</span></a>
                                    </li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <a href="{{ link.url | escape }}"><span>{{ link.name | escape }}</span></a>
                        {% endif %}
                    </li>
                {% endfor %}
            {% endif %}
        </ul>
        
        <!-- Desktop nav -->
        <ul class="usa-nav__primary usa-nav__primary--desktop">
            {% if primary_nav %}
                {% for link in primary_nav.weblinks %}
                    <li class="usa-nav__primary-item">
                        <a class="usa-nav__link" href="{{ link.url | escape }}">
                            <span>{{ link.name | escape }}</span>
                        </a>
                    </li>
                {% endfor %}
            {% endif %}
        </ul>
        
        <!-- Secondary Navigation -->
        <div class="usa-nav__secondary">
            {% assign search_enabled = settings['Search/Enabled'] | boolean | default:true %}
            {% if search_enabled %}
                <form class="site-search usa-search usa-search--small" action="{{ sitemarkers['Search'].url | escape }}" method="get">
                    <div role="search">
                        <label class="usa-sr-only" for="search-field-small">{{ snippets["Header/Search/ToolTip"] | default:resx["Search_DefaultText"] | escape }}</label>
                        <input class="usa-input" id="search-field-small" type="search" name="query" placeholder="{{ snippets["Header/Search/ToolTip"] | default:resx["Search_DefaultText"] | escape }}">
                        <button class="usa-button" type="submit">
                            <span class="usa-search__submit-icon" aria-hidden="true">üîç</span>
                        </button>
                    </div>
                </form>
            {% endif %}

            {% if website.languages.size > 1 %}
                <div class="usa-nav__secondary-item">
                    <a class="usa-nav__link" href="#" title="{{ website.selected_language.name | escape }}">
                        {{ website.selected_language.name | escape }}
                    </a>
                </div>
            {% endif %}

            {% assign profile_enabled = settings['Profile/Enabled'] | boolean | default: true %}
            {% if profile_enabled %}
                {% if user %}
                    <div class="usa-nav__secondary-item">
                        <a class="usa-nav__link" href="{{ sitemarkers['Profile'].url | escape }}" title="{{ user.fullname | escape | default: resx['Default_Profile_name'] }}">
                            {{ user.fullname | escape | default: resx['Default_Profile_name'] }}
                        </a>
                    </div>
                    <div class="usa-nav__secondary-item">
                        <a class="usa-nav__link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_out_url_substitution }}" title="{{ snippets["links/logout"] | default:resx["Sign_Out"] | escape }}">
                            {{ snippets["links/logout"] | default:resx["Sign_Out"] | escape }}
                        </a>
                    </div>
                {% else %}
                    <div class="usa-nav__secondary-item">
                        <a class="usa-nav__link" href="{% if homeurl%}/{{ homeurl }}{% endif %}{{ website.sign_in_url_substitution }}">
                            {{ snippets["links/login"] | default:resx["Sign_In"] | escape }}
                        </a>
                    </div>
                {% endif %}
            {% endif %}
        </div>
    </div>
</nav>
<div class="usa-overlay"></div>


{% substitution %}
{% assign current_page = page.id %}
{% assign sr_page = sitemarkers["Search"].id %}
{% assign forum_page = sitemarkers["Forums"].id %}
{% if current_page %}
  {% if current_page == sr_page or current_page == forum_page %}
    {% assign section_class = "section-landing-search" %}
    {% if current_page == forum_page %}
      {% assign section_class = "section-landing-forums" %}
    {% endif %}
<section class="page_section {{ section_class | h }} color-inverse">
    <div class="row sectionBlockLayout sectionFixedStyle" style="display: flex; flex-wrap: wrap; text-align: center;">
        <div class="container" style="display: flex; flex-wrap: wrap;">
            <div class="col-lg-12 columnBlockLayout" style="display: flex; flex-direction: column; justify-content: center;">
                {% if current_page == sr_page %}
                <h1 id="mainContent">{% editable snippets 'Search/Title' default: resx["Discover_Contoso"] %}</h1>
                {% include 'Search' search_id:'search_control' %}
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endif %}
{% endsubstitution %}
<script type="text/javascript">
    // USWDS Banner functionality
    document.addEventListener('DOMContentLoaded', function() {
        var bannerButton = document.querySelector('.usa-banner__button');
        var bannerContent = document.querySelector('.usa-banner__content');
        
        if (bannerButton && bannerContent) {
            bannerButton.addEventListener('click', function() {
                var isExpanded = bannerButton.getAttribute('aria-expanded') === 'true';
                bannerButton.setAttribute('aria-expanded', !isExpanded);
                
                if (isExpanded) {
                    bannerContent.setAttribute('hidden', '');
                } else {
                    bannerContent.removeAttribute('hidden');
                }
            });
        }
        
        // Mobile navigation functionality
        var menuButton = document.querySelector('.usa-menu-btn');
        var nav = document.querySelector('.usa-nav');
        var overlay = document.querySelector('.usa-overlay');
        var closeButton = document.querySelector('.usa-nav__close');
        
        if (menuButton && nav && overlay) {
            menuButton.addEventListener('click', function() {
                nav.classList.toggle('is-visible');
                overlay.style.display = nav.classList.contains('is-visible') ? 'block' : 'none';
                document.body.style.overflow = nav.classList.contains('is-visible') ? 'hidden' : '';
            });
            
            if (closeButton) {
                closeButton.addEventListener('click', function() {
                    nav.classList.remove('is-visible');
                    overlay.style.display = 'none';
                    document.body.style.overflow = '';
                });
            }
            
            overlay.addEventListener('click', function() {
                nav.classList.remove('is-visible');
                overlay.style.display = 'none';
                document.body.style.overflow = '';
            });
        }
        
        // Mobile accordion functionality
        var accordionButtons = document.querySelectorAll('.usa-nav__primary--mobile .usa-accordion__button');
        accordionButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                var target = document.getElementById(button.getAttribute('aria-controls'));
                var isExpanded = button.getAttribute('aria-expanded') === 'true';
                
                button.setAttribute('aria-expanded', !isExpanded);
                
                if (isExpanded) {
                    target.setAttribute('hidden', '');
                } else {
                    target.removeAttribute('hidden');
                }
            });
        });
    });
</script>
